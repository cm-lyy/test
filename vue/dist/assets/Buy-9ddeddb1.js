/* empty css             *//* empty css                   */import{r as y}from"./request-4a7e5a78.js";/* empty css               *//* empty css                  *//* empty css                     *//* empty css                *//* empty css                */import{r as S,o as n,c as d,g as s,d as c,w as r,a5 as h,Q as v,P as f,i as _,j as k,s as B,L as U,a6 as P,Y as $,k as p,t as i,E as C,a7 as T,a8 as j,a3 as D,a9 as F}from"./index-b4448272.js";const q={style:{"padding-bottom":"50px"}},A={class:"card",style:{"margin-bottom":"10px"}},G={style:{"margin-bottom":"10px"}},J={class:"card"},M=["src"],O={style:{"font-size":"18px",margin:"5px 0",color:"#333"}},Q={class:"line2",style:{margin:"5px 0",color:"#666","font-size":"14px",height:"40px"}},R={key:1,class:"line2",style:{margin:"5px 0",color:"#666","font-size":"14px",height:"40px"}},Y={style:{margin:"5px 0"}},H={style:{margin:"10px 0",display:"flex","align-items":"center",color:"#666"}},K={style:{flex:"1"}},W={style:{color:"red","font-size":"18px"}},X={style:{flex:"1","text-align":"center"}},Z={key:2,style:{display:"flex","align-items":"center","justify-content":"flex-end"}},ee={style:{"margin-right":"5px",display:"inline-block","min-width":"50px","font-size":"18px",color:"red"}},te={key:1,style:{padding:"50px 0","text-align":"center","font-size":"24px",color:"#888"}},oe={key:2,class:"card"},ue={__name:"Buy",setup(ae){const t=S({user:JSON.parse(localStorage.getItem("system-user")||"{}"),categoryList:[],pageNum:1,pageSize:10,total:0,goodsList:[],name:"",activeCategoryId:null}),z=o=>{let a={goodsId:o.id,num:o.num,userId:t.user.id};y.post("/orders/add",a).then(l=>{l.code==="200"?(C.success("购买成功"),g()):C.error(l.msg)})},E=o=>{o.total=(o.price*o.num).toFixed(2)};y.get("/category/selectAll").then(o=>{t.categoryList=o.data});const g=()=>{y.get("/goods/selectPage",{params:{pageNum:t.pageNum,pageSize:t.pageSize,name:t.name,categoryId:t.activeCategoryId}}).then(o=>{var a,l;t.goodsList=(a=o.data)==null?void 0:a.list,t.total=(l=o.data)==null?void 0:l.total,t.goodsList.forEach(m=>{m.num=0})})},x=o=>{t.activeCategoryId=o,g()};return g(),(o,a)=>{const l=B,m=U,I=T,N=j,V=D,b=F,w=P,L=$;return n(),d("div",q,[s("div",A,[c(l,{class:h({active:t.activeCategoryId===null}),onClick:a[0]||(a[0]=e=>x(null))},{default:r(()=>[p("全部")]),_:1},8,["class"]),(n(!0),d(v,null,f(t.categoryList,e=>(n(),_(l,{class:h({active:t.activeCategoryId===e.id}),onClick:u=>x(e.id),key:e.id},{default:r(()=>[p(i(e.name),1)]),_:2},1032,["class","onClick"]))),128))]),s("div",G,[c(m,{style:{width:"300px","margin-right":"5px"},modelValue:t.name,"onUpdate:modelValue":a[1]||(a[1]=e=>t.name=e),placeholder:"请输入商品名称关键字查询"},null,8,["modelValue"]),c(l,{type:"primary"},{default:r(()=>[p("搜索")]),_:1})]),t.total>0?(n(),_(w,{key:0,gutter:10},{default:r(()=>[(n(!0),d(v,null,f(t.goodsList,e=>(n(),_(b,{style:{"margin-bottom":"10px"},span:6,key:e.id},{default:r(()=>[s("div",J,[s("img",{src:e.img,alt:"",style:{width:"100%",height:"280px"}},null,8,M),s("div",O,i(e.name),1),e.descr.length>40?(n(),_(I,{key:0,content:e.descr,effect:"light",placement:"top"},{default:r(()=>[s("div",Q,i(e.descr),1)]),_:2},1032,["content"])):(n(),d("div",R,i(e.descr),1)),s("div",Y,[c(N,{type:"success"},{default:r(()=>[p(i(e.specials),1)]),_:2},1024)]),s("div",H,[s("div",K,[s("strong",W,"￥"+i(e.price),1),p("/"+i(e.unit),1)]),s("div",X," 库存："+i(e.store),1),s("div",null,[c(V,{onChange:u=>E(e),modelValue:e.num,"onUpdate:modelValue":u=>e.num=u,style:{width:"120px"},min:0,max:999},null,8,["onChange","modelValue","onUpdate:modelValue"])])]),e.num>0?(n(),d("div",Z,[p(" 总价："),s("strong",ee,"￥"+i(e.total),1),c(l,{type:"primary",onClick:u=>z(e)},{default:r(()=>[p("购买")]),_:2},1032,["onClick"])])):k("",!0)])]),_:2},1024))),128))]),_:1})):(n(),d("div",te,"暂无农产品...")),t.total?(n(),d("div",oe,[c(L,{onCurrentChange:g,background:"",layout:"prev, pager, next","page-size":t.pageSize,"onUpdate:pageSize":a[2]||(a[2]=e=>t.pageSize=e),"current-page":t.pageNum,"onUpdate:currentPage":a[3]||(a[3]=e=>t.pageNum=e),total:t.total},null,8,["page-size","current-page","total"])])):k("",!0)])}}};export{ue as default};
