/* empty css             *//* empty css               *//* empty css                *//* empty css                  *//* empty css              *//* empty css                 *//* empty css                   */import{r as f}from"./request-4a7e5a78.js";/* empty css               *//* empty css                  *//* empty css                     *//* empty css                *//* empty css                     *//* empty css                *//* empty css                    */import{I as J,r as M,o as _,c,g,d as o,w as t,j as w,L as O,s as T,X as F,Y as j,W as A,k as d,E as u,Z as G,$ as K,a0 as L,K as W,M as X,N as Y,O as Z,J as H}from"./index-b4448272.js";const Q={class:"card",style:{"margin-bottom":"5px"}},ee={class:"card",style:{"margin-bottom":"5px"}},oe={style:{"margin-bottom":"10px"}},le={key:0},ae={key:0,class:"card"},te={class:"dialog-footer"},ve={__name:"User",setup(re){const y="http://lilili.qicp.vip:9080/api//files/upload",x={username:[{required:!0,message:"请输入账号",trigger:"blur"},{min:3,max:15,message:"账号长度应在 3 到 15 个字符之间",trigger:"blur"}],name:[{required:!0,message:"请输入名称",trigger:"blur"},{min:1,max:20,message:"名称长度应在 1 到 20 个字符之间",trigger:"blur"}],password:[{validator:(s,l,r)=>{l?l.length<5?r(new Error("密码长度不能小于 5 位")):l.length>20?r(new Error("密码长度不能大于 20 位")):r():r()},trigger:"blur"}],confirmPassword:[{validator:(s,l,r)=>{!e.form.password&&l?r(new Error("请先输入密码")):e.form.password?l?l!==e.form.password?r(new Error("两次输入密码不一致")):r():r(new Error("请确认密码")):r()},trigger:"blur"}]},b=J(null),e=M({pageNum:1,pageSize:10,total:0,formVisible:!1,form:{},tableData:[],name:null,username:null}),i=()=>{e.username=e.name,f.get("/user/selectPage",{params:{pageNum:e.pageNum,pageSize:e.pageSize,name:e.name,username:e.username}}).then(s=>{var l,r;e.tableData=(l=s.data)==null?void 0:l.list,e.total=(r=s.data)==null?void 0:r.total})},E=()=>{e.form={},e.formVisible=!0},v=s=>{e.form=JSON.parse(JSON.stringify(s)),e.form.password="",e.formVisible=!0},N=()=>{f.post("/user/add",e.form).then(s=>{s.code==="200"?(i(),u.success("操作成功"),e.formVisible=!1):u.error(s.msg)})},U=()=>{f.put("/user/update",e.form).then(s=>{s.code==="200"?(i(),u.success("操作成功"),e.formVisible=!1):u.error(s.msg)})},C=()=>{b.value.validate(s=>{s?e.form.id?(e.form.password||delete e.form.password,U()):N():u.error("会不会好好输入！！")})},h=s=>{G.confirm("删除后数据无法恢复，您确定删除吗?","删除确认",{type:"warning"}).then(l=>{f.delete("/user/delete/"+s).then(r=>{r.code==="200"?(i(),u.success("操作成功")):u.error(r.msg)})}).catch(l=>{})},k=()=>{e.name=null,i()},S=s=>{e.form.avatar=s.data};return i(),(s,l)=>{const r=O,n=T,m=K,P=L,z=F,R=j,B=W,p=X,V=Y,D=Z,I=H,q=A;return _(),c("div",null,[g("div",Q,[o(r,{modelValue:e.name,"onUpdate:modelValue":l[0]||(l[0]=a=>e.name=a),style:{width:"300px","margin-right":"10px"},placeholder:"请输入用户名或名称查询"},null,8,["modelValue"]),o(n,{type:"primary",onClick:i},{default:t(()=>[d("查询")]),_:1}),o(n,{type:"info",style:{margin:"0 10px"},onClick:k},{default:t(()=>[d("重置")]),_:1})]),g("div",ee,[g("div",oe,[o(n,{type:"primary",onClick:E},{default:t(()=>[d("新增")]),_:1})]),o(z,{data:e.tableData,stripe:""},{default:t(()=>[o(m,{label:"用户名",prop:"username"}),o(m,{label:"名称",prop:"name"}),o(m,{label:"头像"},{default:t(a=>[o(P,{style:{width:"50px",height:"50px","border-radius":"5px"},src:a.row.avatar,"preview-src-list":[a.row.avatar],"preview-teleported":""},null,8,["src","preview-src-list"])]),_:1}),o(m,{label:"角色",prop:"role"},{default:t(a=>[a.row.role==="USER"?(_(),c("span",le,"普通用户")):w("",!0)]),_:1}),o(m,{label:"性别",prop:"sex"}),o(m,{label:"手机号码",prop:"phoneNumber"}),o(m,{label:"邮箱",prop:"email"}),o(m,{label:"操作","header-align":"center",width:"160"},{default:t(a=>[o(n,{type:"primary",onClick:$=>v(a.row)},{default:t(()=>[d("编辑")]),_:2},1032,["onClick"]),o(n,{type:"danger",onClick:$=>h(a.row.id)},{default:t(()=>[d("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),e.total?(_(),c("div",ae,[o(R,{onCurrentChange:i,background:"",layout:"prev, pager, next","page-size":e.pageSize,"onUpdate:pageSize":l[1]||(l[1]=a=>e.pageSize=a),"current-page":e.pageNum,"onUpdate:currentPage":l[2]||(l[2]=a=>e.pageNum=a),total:e.total},null,8,["page-size","current-page","total"])])):w("",!0),o(q,{title:"信息",width:"40%",modelValue:e.formVisible,"onUpdate:modelValue":l[11]||(l[11]=a=>e.formVisible=a),"close-on-click-modal":!1,"destroy-on-close":""},{footer:t(()=>[g("span",te,[o(n,{onClick:l[10]||(l[10]=a=>e.formVisible=!1)},{default:t(()=>[d("取 消")]),_:1}),o(n,{type:"primary",onClick:C},{default:t(()=>[d("保 存")]),_:1})])]),default:t(()=>[o(I,{ref_key:"formRef",ref:b,model:e.form,rules:x,"label-width":"100px",style:{"padding-right":"50px"}},{default:t(()=>[o(p,{label:"头像",prop:"avatar"},{default:t(()=>[o(B,{action:y,"list-type":"picture","on-success":S},{default:t(()=>[o(n,{type:"primary"},{default:t(()=>[d("上传图片")]),_:1})]),_:1})]),_:1}),o(p,{label:"账号",prop:"username"},{default:t(()=>[o(r,{modelValue:e.form.username,"onUpdate:modelValue":l[3]||(l[3]=a=>e.form.username=a),autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(p,{label:"名称",prop:"name"},{default:t(()=>[o(r,{modelValue:e.form.name,"onUpdate:modelValue":l[4]||(l[4]=a=>e.form.name=a),autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(p,{label:"密码",prop:"password"},{default:t(()=>[o(r,{modelValue:e.form.password,"onUpdate:modelValue":l[5]||(l[5]=a=>e.form.password=a),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(p,{label:"确认密码",prop:"confirmPassword"},{default:t(()=>[o(r,{modelValue:e.form.confirmPassword,"onUpdate:modelValue":l[6]||(l[6]=a=>e.form.confirmPassword=a),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(p,{label:"性别",prop:"sex"},{default:t(()=>[o(D,{modelValue:e.form.sex,"onUpdate:modelValue":l[7]||(l[7]=a=>e.form.sex=a)},{default:t(()=>[o(V,{label:"男"}),o(V,{label:"女"})]),_:1},8,["modelValue"])]),_:1}),o(p,{label:"手机号码",prop:"phoneNumber"},{default:t(()=>[o(r,{modelValue:e.form.phoneNumber,"onUpdate:modelValue":l[8]||(l[8]=a=>e.form.phoneNumber=a),autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(p,{label:"邮箱",prop:"email"},{default:t(()=>[o(r,{modelValue:e.form.email,"onUpdate:modelValue":l[9]||(l[9]=a=>e.form.email=a),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}};export{ve as default};
