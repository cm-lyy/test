/* empty css             *//* empty css                  *//* empty css                *//* empty css                     */import{r as d}from"./request-4a7e5a78.js";import{_ as U}from"./login-left-qte69_UC-b0eb4b47.js";import{_ as V,I as m,r as C,aa as I,o as F,c as B,g as t,d as a,w as c,E as r,J as k,u as R,k as y,G as S,H as q,L as z,M as L,a0 as M,s as N,ad as T}from"./index-b4448272.js";const _=p=>(S("data-v-134672f4"),p=p(),q(),p),j={class:"register-container"},O={class:"register-boxOne"},$=_(()=>t("div",null,[t("img",{class:"register-image",src:U,alt:"login"})],-1)),G={class:"register-boxTwo"},H=_(()=>t("div",{class:"register-title"}," 找 回 帐 号 ",-1)),J={style:{display:"flex"}},A=_(()=>t("div",{style:{display:"flex","justify-content":"space-between","align-items":"center"}},[t("div",null,[t("a",{href:"/byebye"},"忘记邮箱？")]),t("div",null,[y(" 想起来了？请 "),t("a",{href:"/login"},"登录")])],-1)),D={__name:"ForgotUsername",setup(p){const f=m(""),g=m(!1),h=m(null),v=async()=>{try{g.value=!0;const e=await d.get("/Captcha/image",{responseType:"blob"});e&&e.data instanceof Blob?f.value=URL.createObjectURL(e.data):r.error("验证码获取失败，返回的数据格式错误")}catch(e){e.response?e.response.status===429?r.error("请求过于频繁，请稍后再试"):r.error(`验证码获取失败，状态码: ${e.response.status}`):r.error(`验证码获取失败，请稍后重试。错误信息: ${e.message}`)}finally{g.value=!1}},o=C({form:{email:""},rules:{email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:["blur","change"]}],captcha:[{required:!0,message:"请输入验证码",trigger:"blur"},{validator:async(e,s,i)=>{try{const l=await d.post("/Captcha/validate",{captcha:s});l.success?i():i(new Error(l.msg||"验证码错误"))}catch{i(new Error("验证码验证失败，请重试"))}},trigger:"blur"}]}}),n=m(!1),x=()=>{n.value||(n.value=!0,h.value.validate(e=>{e?d.post("/ForgotUsername",o.form).then(s=>{n.value=!1,s.code==="200"?r.success("账号名已发送到您的邮箱，请注意查收"):r.error(s.msg||"找回账号失败")}).catch(()=>{n.value=!1,r.error("请求失败，请稍后重试")}):(n.value=!1,r.error("请完善表单信息"))}))};return I(()=>{v()}),(e,s)=>{const i=z,l=L,b=M,w=N,E=k;return F(),B("div",j,[t("div",O,[$,t("div",G,[H,a(E,{model:o.form,ref_key:"formRef",ref:h,rules:o.rules},{default:c(()=>[a(l,{prop:"Email"},{default:c(()=>[a(i,{"prefix-icon":R(T),size:"large",modelValue:o.form.email,"onUpdate:modelValue":s[0]||(s[0]=u=>o.form.email=u),placeholder:"请输入账号绑定的邮箱"},null,8,["prefix-icon","modelValue"])]),_:1}),a(l,{prop:"captcha"},{default:c(()=>[t("div",J,[a(i,{size:"large",modelValue:o.form.captcha,"onUpdate:modelValue":s[1]||(s[1]=u=>o.form.captcha=u),placeholder:"请输入验证码",style:{flex:"1",width:"150px"}},null,8,["modelValue"]),a(b,{style:{width:"175px",height:"40px","margin-left":"10px"},onClick:v,src:f.value,fit:"contain"},null,8,["src"])])]),_:1}),a(l,null,{default:c(()=>[a(w,{size:"large",type:"primary",style:{width:"100%","margin-top":"2%"},onClick:x},{default:c(()=>[y("找回账号")]),_:1})]),_:1})]),_:1},8,["model","rules"]),A])])])}}},te=V(D,[["__scopeId","data-v-134672f4"]]);export{te as default};
