/* empty css             *//* empty css               *//* empty css                *//* empty css                  *//* empty css                 *//* empty css                   */import{r as f}from"./request-4a7e5a78.js";/* empty css               *//* empty css                  *//* empty css                     *//* empty css                *//* empty css                     *//* empty css                *//* empty css                    */import{I as M,r as $,o as c,c as _,g,d as t,w as l,j as b,L as A,s as J,X as R,Y as T,W as F,k as m,E as d,Z as O,$ as j,a0 as K,K as L,M as W,J as X}from"./index-b4448272.js";const Y={class:"card",style:{"margin-bottom":"5px"}},Z={class:"card",style:{"margin-bottom":"5px"}},G={style:{"margin-bottom":"10px"}},H={key:0},Q={key:0,class:"card"},ee={class:"dialog-footer"},be={__name:"Admin",setup(oe){const V="http://lilili.qicp.vip:9080/api//files/upload",y={username:[{required:!0,message:"请输入账号",trigger:"blur"},{min:3,max:15,message:"账号长度应在 3 到 15 个字符之间",trigger:"blur"}],name:[{required:!0,message:"请输入名称",trigger:"blur"},{min:1,max:20,message:"名称长度应在 1 到 20 个字符之间",trigger:"blur"}],password:[{validator:(s,o,r)=>{o?o.length<5?r(new Error("密码长度不能小于 5 位")):o.length>20?r(new Error("密码长度不能大于 20 位")):r():r()},trigger:"blur"}],confirmPassword:[{validator:(s,o,r)=>{!e.form.password&&o?r(new Error("请先输入密码")):e.form.password?o?o!==e.form.password?r(new Error("两次输入密码不一致")):r():r(new Error("请确认密码")):r()},trigger:"blur"}]},w=M(null),e=$({username:"",name:"",pageNum:1,pageSize:10,tableData:[],total:0,form:{},formVisible:!1}),i=()=>{e.username=e.name,f.get("/admin/selectPage",{params:{pageNum:e.pageNum,pageSize:e.pageSize,name:e.name,username:e.username}}).then(s=>{var o,r;e.tableData=(o=s.data)==null?void 0:o.list,e.total=(r=s.data)==null?void 0:r.total})},E=()=>{e.form={},e.formVisible=!0},x=s=>{e.form=JSON.parse(JSON.stringify(s)),e.form.password="",e.formVisible=!0},v=()=>{f.post("/admin/add",e.form).then(s=>{s.code==="200"?(i(),d.success("操作成功"),e.formVisible=!1):d.error(s.msg)})},h=()=>{f.put("/admin/update",e.form).then(s=>{s.code==="200"?(i(),d.success("操作成功"),e.formVisible=!1):d.error(s.msg)})},C=()=>{w.value.validate(s=>{s?e.form.id?(e.form.password||delete e.form.password,h()):v():d.error("会不会好好输入！！")})},N=s=>{O.confirm("删除后数据无法恢复，您确定删除吗?","删除确认",{type:"warning"}).then(o=>{f.delete("/admin/delete/"+s).then(r=>{r.code==="200"?(i(),d.success("操作成功")):d.error(r.msg)})}).catch(o=>{})},k=()=>{e.name=null,i()},U=s=>{e.form.avatar=s.data};return i(),(s,o)=>{const r=A,n=J,p=j,P=K,S=R,z=T,D=L,u=W,I=X,B=F;return c(),_("div",null,[g("div",Y,[t(r,{modelValue:e.name,"onUpdate:modelValue":o[0]||(o[0]=a=>e.name=a),style:{width:"300px","margin-right":"10px"},placeholder:"请输入用户名或名称查询"},null,8,["modelValue"]),t(n,{type:"primary",onClick:i},{default:l(()=>[m("查询")]),_:1}),t(n,{type:"info",style:{margin:"0 10px"},onClick:k},{default:l(()=>[m("重置")]),_:1})]),g("div",Z,[g("div",G,[t(n,{type:"primary",onClick:E},{default:l(()=>[m("新增")]),_:1})]),t(S,{data:e.tableData,stripe:""},{default:l(()=>[t(p,{label:"用户名",prop:"username"}),t(p,{label:"名称",prop:"name"}),t(p,{label:"头像"},{default:l(a=>[t(P,{src:a.row.avatar,style:{width:"40px",height:"40px","border-radius":"50%"}},null,8,["src"])]),_:1}),t(p,{label:"角色",prop:"role"},{default:l(a=>[a.row.role==="ADMIN"?(c(),_("span",H,"管理员")):b("",!0)]),_:1}),t(p,{label:"操作",align:"center",width:"160"},{default:l(a=>[t(n,{type:"primary",onClick:q=>x(a.row)},{default:l(()=>[m("编辑")]),_:2},1032,["onClick"]),t(n,{type:"danger",onClick:q=>N(a.row.id)},{default:l(()=>[m("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),e.total?(c(),_("div",Q,[t(z,{onCurrentChange:i,background:"",layout:"prev, pager, next","page-size":e.pageSize,"onUpdate:pageSize":o[1]||(o[1]=a=>e.pageSize=a),"current-page":e.pageNum,"onUpdate:currentPage":o[2]||(o[2]=a=>e.pageNum=a),total:e.total},null,8,["page-size","current-page","total"])])):b("",!0),t(B,{title:"信息",width:"40%",modelValue:e.formVisible,"onUpdate:modelValue":o[8]||(o[8]=a=>e.formVisible=a),"close-on-click-modal":!1,"destroy-on-close":""},{footer:l(()=>[g("span",ee,[t(n,{onClick:o[7]||(o[7]=a=>e.formVisible=!1)},{default:l(()=>[m("取 消")]),_:1}),t(n,{type:"primary",onClick:C},{default:l(()=>[m("保 存")]),_:1})])]),default:l(()=>[t(I,{ref_key:"formRef",ref:w,model:e.form,rules:y,"label-width":"100px",style:{"padding-right":"50px"}},{default:l(()=>[t(u,{label:"头像",prop:"avatar"},{default:l(()=>[t(D,{action:V,"list-type":"picture","on-success":U},{default:l(()=>[t(n,{type:"primary"},{default:l(()=>[m("上传图片")]),_:1})]),_:1})]),_:1}),t(u,{label:"账号",prop:"username"},{default:l(()=>[t(r,{modelValue:e.form.username,"onUpdate:modelValue":o[3]||(o[3]=a=>e.form.username=a),autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(u,{label:"名称",prop:"name"},{default:l(()=>[t(r,{modelValue:e.form.name,"onUpdate:modelValue":o[4]||(o[4]=a=>e.form.name=a),autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(u,{label:"密码",prop:"password"},{default:l(()=>[t(r,{modelValue:e.form.password,"onUpdate:modelValue":o[5]||(o[5]=a=>e.form.password=a),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(u,{label:"确认密码",prop:"confirmPassword"},{default:l(()=>[t(r,{modelValue:e.form.confirmPassword,"onUpdate:modelValue":o[6]||(o[6]=a=>e.form.confirmPassword=a),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}};export{be as default};
