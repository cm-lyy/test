/* empty css             *//* empty css                  *//* empty css                *//* empty css              */import{r as f}from"./request-4a7e5a78.js";/* empty css                 *//* empty css             */import{_ as w,I as C,r as I,b as k,o as i,c as d,g as m,d as o,w as s,J as S,i as B,j as P,k as O,E as u,l as q,K as J,L as M,M as R,N as $,O as F,s as j}from"./index-b4448272.js";const D={style:{width:"50%"}},T={class:"card",style:{padding:"30px"}},A={style:{margin:"20px","text-align":"center"}},G=["src"],K={key:0},L={style:{"text-align":"center"}},z={props:{visible:{type:Boolean,required:!0},imageUrl:{type:String,required:!0}},data(){return{cropper:null}},watch:{visible(r){r?this.$nextTick(()=>{this.initCropper()}):this.cropper&&(this.cropper.destroy(),this.cropper=null)}},methods:{initCropper(){const r=this.$refs.image;this.cropper=new Cropper(r,{aspectRatio:1,viewMode:1})},cropImage(){this.cropper&&this.cropper.getCroppedCanvas().toBlob(r=>{console.log(r),this.$emit("update:visible",!1)})},cancelCrop(){this.$emit("update:visible",!1)}}},H=Object.assign(z,{__name:"Person",emits:["updateUser"],setup(r,{emit:g}){C(!1);const e=I({user:JSON.parse(localStorage.getItem("system-user")||"{}")}),v=l=>{e.user.avatar=l.data},h="http://lilili.qicp.vip:9080/api//files/upload",c=g,y=()=>{const l={...e.user};delete l.password,delete l.newPassword,e.user.role==="ADMIN"?f.put("/admin/update",l).then(t=>{t.code==="200"?(u.success("更新成功"),localStorage.setItem("system-user",JSON.stringify(e.user)),c("updateUser")):u.error(t.msg)}):f.put("/user/update",l).then(t=>{t.code==="200"?(u.success("更新成功"),localStorage.setItem("system-user",JSON.stringify(e.user)),c("updateUser")):u.error(t.msg)})};return(l,t)=>{const V=k("Plus"),b=q,x=J,p=M,n=R,_=$,U=F,E=j,N=S;return i(),d("div",D,[m("div",T,[o(N,{model:e.user,style:{"padding-right":"50px"}},{default:s(()=>[m("div",A,[o(x,{"show-file-list":!1,class:"avatar-uploader",action:h,"on-success":v},{default:s(()=>[e.user.avatar?(i(),d("img",{key:0,src:e.user.avatar,class:"avatar"},null,8,G)):(i(),B(b,{key:1,class:"avatar-uploader-icon"},{default:s(()=>[o(V)]),_:1}))]),_:1})]),o(n,{label:"账号"},{default:s(()=>[o(p,{disabled:"",modelValue:e.user.username,"onUpdate:modelValue":t[0]||(t[0]=a=>e.user.username=a),autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(n,{label:"名称"},{default:s(()=>[o(p,{modelValue:e.user.name,"onUpdate:modelValue":t[1]||(t[1]=a=>e.user.name=a),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e.user.role==="USER"?(i(),d("div",K,[o(n,{label:"性别",prop:"sex"},{default:s(()=>[o(U,{modelValue:e.user.sex,"onUpdate:modelValue":t[2]||(t[2]=a=>e.user.sex=a)},{default:s(()=>[o(_,{label:"男"}),o(_,{label:"女"})]),_:1},8,["modelValue"])]),_:1}),o(n,{label:"电话",prop:"phone"},{default:s(()=>[o(p,{modelValue:e.user.phoneNumber,"onUpdate:modelValue":t[3]||(t[3]=a=>e.user.phoneNumber=a),autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(n,{label:"邮箱",prop:"email"},{default:s(()=>[o(p,{modelValue:e.user.email,"onUpdate:modelValue":t[4]||(t[4]=a=>e.user.email=a),autocomplete:"off"},null,8,["modelValue"])]),_:1})])):P("",!0),m("div",L,[o(E,{type:"primary",onClick:y},{default:s(()=>[O("保存")]),_:1})])]),_:1},8,["model"])])])}}}),se=w(H,[["__scopeId","data-v-8830c5ee"]]);export{se as default};
